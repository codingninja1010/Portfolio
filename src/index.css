@tailwind base;
@tailwind components;
@tailwind utilities;

/* Animated Scrollbar: register custom property globally so Edge/Chrome apply it reliably */
@property --sb-angle {
  syntax: '<angle>';
  inherits: false;
  initial-value: 0deg;
}
@keyframes sbAngleSpin { to { --sb-angle: 360deg; } }

/* Definition of the design system. All colors, gradients, fonts, etc should be defined here. 
All colors MUST be HSL.
*/

@layer base {
  :root {
    /* Core theme colors */
    --background: 220 15% 6%;
    --foreground: 210 40% 98%;

    /* Card colors */
    --card: 220 15% 8%;
    --card-foreground: 210 40% 98%;

    /* Popover colors */
    --popover: 220 15% 8%;
    --popover-foreground: 210 40% 98%;

    /* Primary tech blue */
    --primary: 217 91% 60%;
    --primary-foreground: 210 40% 98%;
    --primary-hover: 217 91% 55%;

    /* Secondary purple */
    --secondary: 262 83% 58%;
    --secondary-foreground: 210 40% 98%;

    /* Muted colors */
    --muted: 217 33% 17%;
    --muted-foreground: 215 20% 65%;

    /* Accent orange */
    --accent: 25 95% 53%;
    --accent-foreground: 210 40% 98%;

    /* Destructive */
    --destructive: 0 84% 60%;
    --destructive-foreground: 210 40% 98%;

    /* Borders and inputs */
    --border: 217 33% 17%;
    --input: 217 33% 17%;
    --ring: 217 91% 60%;

    /* Border radius */
    --radius: 0.75rem;

    /* Custom gradients with better contrast */
    --gradient-primary: linear-gradient(135deg, hsl(217 91% 70%), hsl(262 83% 75%));
    --gradient-secondary: linear-gradient(135deg, hsl(262 83% 58%), hsl(25 95% 53%));
    --gradient-background: linear-gradient(135deg, hsl(220 15% 6%), hsl(217 33% 10%));
    --gradient-card: linear-gradient(135deg, hsl(220 15% 8% / 0.8), hsl(217 33% 12% / 0.6));

    /* Shadows */
    --shadow-glow: 0 0 40px hsl(217 91% 60% / 0.3);
    --shadow-card: 0 8px 32px hsl(220 15% 3% / 0.4);
    --shadow-primary: 0 4px 20px hsl(217 91% 60% / 0.4);

    --sidebar-background: 0 0% 98%;

    --sidebar-foreground: 240 5.3% 26.1%;

    --sidebar-primary: 240 5.9% 10%;

    --sidebar-primary-foreground: 0 0% 98%;

    --sidebar-accent: 240 4.8% 95.9%;

    --sidebar-accent-foreground: 240 5.9% 10%;

    --sidebar-border: 220 13% 91%;

    --sidebar-ring: 217.2 91.2% 59.8%;
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;

    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;

    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;

    --primary: 210 40% 98%;
    --primary-foreground: 222.2 47.4% 11.2%;

    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;

    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply bg-background text-foreground;
    background: var(--gradient-background);
    scroll-behavior: smooth;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
  }

  /* Ensure anchors and scrollIntoView leave space for the fixed header */
  html {
    /* Default fallback; will be updated dynamically by JS */
    scroll-padding-top: var(--app-scroll-padding, 6.5rem);
  /* Reserve space on one side only so a left white gutter does not appear */
  scrollbar-gutter: stable;
  }

  /* Utility class to apply dynamic scroll margin for anchored sections */
  .section-anchor {
    scroll-margin-top: var(--app-scroll-padding, 6.5rem);
  }

  /* Extra safety: when navigating to an element with a hash, ensure it keeps space from the top */
  :target {
    scroll-margin-top: 6.5rem;
  }

  /* Glass morphism utility */
  .glass {
    background: var(--gradient-card);
    backdrop-filter: blur(12px);
    border: 1px solid hsl(var(--border));
    box-shadow: var(--shadow-card);
    /* Smooth transform for global hover scaling */
    transform: translateZ(0);
    transition: transform 280ms ease, box-shadow 280ms ease;
    will-change: transform;
  }

  /* Larger, attractive hover scale for glass cards on pointer devices only */
  @media (hover: hover) and (pointer: fine) {
    .glass:hover {
      transform: scale(1.06) !important;
    }
  }

  /* --- Icon button press animation utility --- */
  .icon-button {
    /* Shrink on press; tweak as needed */
    --press-scale: 0.9;
  inline-size: 52px;
  block-size: 52px;
    display: inline-grid;
    place-items: center;
    border-radius: 12px;
    /* Keep existing glass visuals if used together */
    transition: transform 140ms ease, background-color 140ms ease, box-shadow 140ms ease;
    will-change: transform;
    user-select: none;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }

  /* Use a much lighter shadow for compact glass icon buttons to avoid a visible seam when several are aligned in a row */
  .icon-button.glass {
    /* Softer external shadow; remove inner top highlight that can align into a seam */
    box-shadow: 0 6px 14px hsl(var(--background) / 0.28);
    border-color: hsl(var(--border) / 0.55);
    position: relative;
    overflow: hidden;
  }

  /* If combined with .glass, avoid global glass hover scale here to prevent double-scaling */
  .icon-button.glass:hover {
    transform: none !important;
    box-shadow: 0 8px 18px hsl(var(--background) / 0.34);
    /* slight tint to base */
    background: linear-gradient(180deg, hsl(var(--foreground) / 0.02), hsl(var(--foreground) / 0.01));
  }

  /* Make press feel snappy and override hover */
  .icon-button.pressed { transform: scale(0.92) !important; transition: transform 110ms ease; }

  /* Dynamic spotlight that follows the cursor (variables set inline on the element) */
  .icon-button.glass::before {
    content: "";
    position: absolute;
    inset: -1px;
    border-radius: inherit;
    pointer-events: none;
    opacity: 0;
    transition: opacity 180ms ease;
    background: radial-gradient(
      140px 140px at var(--mx, 50%) var(--my, 50%),
      hsl(var(--primary) / 0.18),
      transparent 60%
    );
  }
  .icon-button.glass:hover::before { opacity: 1; }

  /* Animated gradient border highlight on hover */
  .icon-button.glass::after {
    content: "";
    position: absolute;
    inset: 0; /* keep inside bounds (masked) */
    border-radius: inherit;
    padding: 1px; /* perceived border width */
    background: conic-gradient(
      from var(--angle, 0deg),
      hsl(var(--primary) / 0),
      hsl(var(--primary) / 0.75) 20%,
      hsl(var(--secondary) / 0.75) 55%,
      hsl(var(--accent) / 0.75) 80%,
      hsl(var(--primary) / 0) 100%
    );
    /* Mask to show as border only */
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
            mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            mask-composite: exclude;
    opacity: 0; /* hidden until hover */
    filter: drop-shadow(0 2px 10px hsl(var(--primary) / 0.35));
    transition: opacity 160ms ease;
  }
  .icon-button.glass:hover::after {
    opacity: 1;
    animation: spinBorder 2.2s linear infinite;
  }

  @keyframes spinBorder { to { transform: rotate(360deg); } }

  .icon-button.pressed,
  .icon-button:active {
    transform: scale(var(--press-scale));
  }

  @media (prefers-reduced-motion: reduce) {
    .icon-button { transition: none; }
    .icon-button.pressed,
    .icon-button:active { transform: none; }
  }

  /* Prevent layout/visual shift on the fixed site header when hovering over it.
     The global .glass:hover scale looks nice on cards but makes the header appear
     to "push apart" its contents as the whole bar scales. Keep header static. */
  header.glass:hover {
    transform: none !important;
  }

  /* Subtle non-layout hover feedback for the header */
  header.glass {
    /* Avoid transform-based stacking quirks from the base .glass rule */
    transform: none !important;
    transition: background-color 200ms ease, box-shadow 200ms ease, border-color 200ms ease;
  }
  header.glass:hover {
    /* Slightly intensify the shadow and add a very soft tint */
    box-shadow: var(--shadow-card), 0 4px 24px hsl(var(--primary) / 0.25);
    background: linear-gradient(135deg, hsl(220 15% 8% / 0.88), hsl(217 33% 12% / 0.72));
    /* Slightly stronger blur/saturation on hover without affecting layout */
    backdrop-filter: blur(14px) saturate(120%);
  }

  /* (Removed) bottom highlight under header */

  /* Optional helper to make specific items even bigger on hover */
  .hover-scale-lg {
    transition: transform 280ms ease;
  }
  .hover-scale-lg:hover { transform: scale(1.12); }

  /* Glow effect utility */
  .glow {
    box-shadow: var(--shadow-glow);
  }

  /* --- Fancy button hover effects --- */
  .btn-border-animate {
    position: relative;
    overflow: hidden;
    border: 1px solid hsl(var(--border));
  }
  .btn-border-animate::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    padding: 1.5px; /* slightly thicker animated border for visibility */
    background: conic-gradient(
      from 0deg,
      hsl(var(--primary) / 0),
      hsl(var(--primary) / 0.7) 20%,
      hsl(var(--secondary) / 0.7) 55%,
      hsl(var(--accent) / 0.7) 80%,
      hsl(var(--primary) / 0) 100%
    );
    -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite: xor;
            mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
            mask-composite: exclude;
    opacity: 0;
    transition: opacity 160ms ease;
  }
  .btn-border-animate:hover::after { opacity: 1; animation: spinBorder 2.4s linear infinite; }

  .btn-shine {
    position: relative;
    overflow: hidden;
  }
  .btn-shine::before {
    content: "";
    position: absolute;
    top: -50%;
    left: -30%;
    width: 55%;
    height: 220%;
    transform: rotate(25deg) translateX(-120%);
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.35), transparent);
    filter: blur(1.5px);
    transition: transform 700ms ease;
    pointer-events: none;
  }
  .btn-shine:hover::before { transform: rotate(25deg) translateX(260%); }

  /* Hover gradient fill for outline buttons */
  .btn-gradient-hover { transition: background 220ms ease, color 220ms ease, border-color 220ms ease, box-shadow 220ms ease; }
  .btn-gradient-hover:hover {
    /* Softer, low-contrast gradient fill so animations stay visible */
    background: linear-gradient(135deg, hsl(var(--primary) / 0.12), hsl(var(--secondary) / 0.12));
    color: inherit;
    border-color: hsl(var(--primary) / 0.35);
    box-shadow: 0 6px 18px hsl(var(--primary) / 0.25);
  }

  /* Gradient text utility with enhanced visibility */
  .gradient-text-enhanced {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    background-clip: text;
    -webkit-text-fill-color: transparent;
    color: transparent;
    font-weight: 700;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    text-rendering: optimizeLegibility;
    /* Add subtle shadow for better visibility */
    filter: drop-shadow(0 0 1px rgba(59, 130, 246, 0.3));
  }

  /* Animation utilities */
  .animate-float {
    animation: float 6s ease-in-out infinite;
  }

  /* Float only for ~3.5s then stop */
  .animate-float-brief {
    animation: float 3.5s ease-in-out 1 both;
  }

  @media (prefers-reduced-motion: reduce) {
    .animate-float-brief { animation: none; }
  }

  .animate-glow {
    animation: glow 2s ease-in-out infinite alternate;
  }

  /* Smooth photo entrance (zoom + fade + slight rise) */
  @keyframes photoEnter {
    0%   { opacity: 0; transform: translateY(14px) scale(0.92); }
    60%  { opacity: 1; }
    100% { opacity: 1; transform: translateY(0) scale(1); }
  }
  .animate-photo-enter { animation: photoEnter 0.7s ease-out both; }

  /* Subtle continuous float for focal elements */
  @keyframes photoFloat {
    0%, 100% { transform: translateY(0); }
    50%      { transform: translateY(-6px); }
  }
  .photo-float { animation: photoFloat 10s ease-in-out infinite; }

  @keyframes float {
    0%, 100% { transform: translateY(0px); }
    50% { transform: translateY(-20px); }
  }

  @keyframes glow {
    from { box-shadow: var(--shadow-card); }
    to { box-shadow: var(--shadow-glow); }
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slideInLeft {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes typing {
    from { width: 0; }
    to { width: 100%; }
  }

  @keyframes blink {
    50% { border-color: transparent; }
  }

  /* Make the caret disappear at the end of typing */
  @keyframes caret-hide {
    to { border-right-color: transparent; }
  }

  .animate-fadeInUp {
    animation: fadeInUp 0.8s ease-out;
  }

  .animate-slideInLeft {
    animation: slideInLeft 0.8s ease-out;
  }

  .animate-typing {
    overflow: hidden;
    white-space: nowrap;
    border-right: 3px solid hsl(var(--primary));
    /* Run typing once, a few blinks, then permanently hide caret */
    animation:
      typing 3.5s steps(40, end) 1 both,
      blink 0.75s step-end 4,
      caret-hide 0.01s linear 3.5s forwards;
  }

  /* --- Hero photo 3D highlight ring & shine sweep --- */
  @keyframes spinRing {
    to { transform: rotate(360deg); }
  }

  @keyframes pulseGlow {
    0%, 100% { opacity: 0.40; filter: drop-shadow(0 0 8px hsl(var(--primary) / 0.35)); }
    50% { opacity: 0.85; filter: drop-shadow(0 0 16px hsl(var(--primary) / 0.6)); }
  }

  .hero-photo-3d .glow-ring {
    position: absolute;
    inset: 0;
    border-radius: 9999px;
    /* Rotating conic gradient rainbow ring */
    background:
      conic-gradient(
        from 0deg,
        #ff004c 0%, /* red */
        #ff7a00 12.5%, /* orange */
        #ffd300 25%, /* yellow */
        #00e676 37.5%, /* green */
        #00e5ff 50%, /* cyan */
        #2979ff 62.5%, /* blue */
        #7c4dff 75%, /* indigo */
        #d500f9 87.5%, /* violet */
        #ff004c 100%
      );
  animation: spinRing 12s linear infinite;
    /* Hollow center to form a ring */
    /* Thicker visible ring so it doesn't get visually lost under the photo edge */
    -webkit-mask: radial-gradient(farthest-side, #0000 calc(100% - 10px), #000 calc(100% - 2px));
      mask: radial-gradient(farthest-side, #0000 calc(100% - 10px), #000 calc(100% - 2px));
    filter: drop-shadow(0 0 12px rgba(59, 130, 246, 0.45));
    opacity: 0.8;
    pointer-events: none;
    z-index: 20;
    transition: opacity .3s ease, filter .3s ease;
    /* Use normal blend to ensure full-circle visibility on all backgrounds */
    mix-blend-mode: normal;
  }

  .hero-photo-3d:hover .glow-ring {
    opacity: 1;
    filter: drop-shadow(0 0 18px rgba(255, 0, 76, 0.55));
    /* intensify on hover */
  }

  /* Inner subtle ring with reverse rotation and gentle pulse */
  .hero-photo-3d .glow-ring-inner {
    position: absolute;
    inset: 8px;
    border-radius: 9999px;
    background: conic-gradient(from 90deg, rgba(255,255,255,0.35), rgba(255,255,255,0.05), rgba(255,255,255,0.35));
    -webkit-mask: radial-gradient(farthest-side, #0000 calc(100% - 8px), #000 calc(100% - 3px));
      mask: radial-gradient(farthest-side, #0000 calc(100% - 8px), #000 calc(100% - 3px));
  animation: spinRing 16s linear infinite reverse, pulseGlow 3.2s ease-in-out infinite;
    opacity: 0.5;
    pointer-events: none;
    z-index: 25;
    mix-blend-mode: normal;
  }

  .hero-photo-3d:hover .glow-ring-inner { opacity: 0.65; }

  /* Subtle breathing float on hover */
  @keyframes breathe {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-6px); }
  }

  .hero-photo-3d:hover .photo-breathe {
    animation: breathe 6s ease-in-out infinite;
  }

  @media (prefers-reduced-motion: reduce) {
    .hero-photo-3d:hover .photo-breathe { animation: none; }
    .hero-photo-3d .glow-ring,
    .hero-photo-3d .glow-ring-inner { animation: none; }
  }

  .hero-photo-3d .shine-sweep {
    position: absolute;
    inset: 0; /* keep inside the circle */
    border-radius: 9999px;
    background: linear-gradient(120deg, transparent 30%, rgba(255,255,255,0.28) 45%, transparent 60%);
    transform: translateX(-150%);
    transition: transform .9s ease, opacity .3s ease;
    opacity: 0;
    mix-blend-mode: screen;
    pointer-events: none;
    z-index: 30;
  }

  .hero-photo-3d:hover .shine-sweep {
    transform: translateX(150%);
    opacity: 1;
  }

  /* Animated Scrollbar (WebKit) + Themed (Firefox) */
  /* --- Glowing ripple rings around the photo --- */
  @keyframes rippleRing {
    0%   { transform: scale(0.95); opacity: 0.55; }
    70%  { opacity: 0.15; }
    100% { transform: scale(1.35); opacity: 0; }
  }

  .hero-photo-3d .ripple-rings {
    position: absolute;
    inset: -10px; /* slightly outside the image circle */
    border-radius: 9999px;
    pointer-events: none;
    z-index: 12;
  }
  .hero-photo-3d .ripple-rings > span {
    position: absolute;
    inset: 0;
    border-radius: inherit;
    border: 2px solid hsl(var(--primary) / 0.35);
    box-shadow: 0 0 20px hsl(var(--primary) / 0.25);
    transform: scale(0.95);
    opacity: 0;
    animation: rippleRing 3.2s ease-out infinite;
  }
  .hero-photo-3d .ripple-rings > span:nth-child(2) { animation-delay: 1.05s; }
  .hero-photo-3d .ripple-rings > span:nth-child(3) { animation-delay: 2.1s; }

  /* Animated, themable native scrollbar (advanced) */

  /* Firefox: thin scrollbar with theme colors */
  * {
    scrollbar-width: thin;
    scrollbar-color: hsl(var(--primary)) transparent;
  }

  /* WebKit browsers (Chrome, Edge, Safari) */
  *::-webkit-scrollbar {
    width: 12px;
    height: 12px;
    background: transparent;
  }
  *::-webkit-scrollbar-track {
    border-radius: 9999px;
    background: hsl(var(--background) / 0.9);
    box-shadow: inset 0 0 0 1px hsl(var(--border) / 0.2);
  }
  *::-webkit-scrollbar-thumb {
    border-radius: 9999px;
    border: 2px solid hsl(var(--background) / 0.6);
    /* Layered backgrounds for depth: conic spin + soft highlight + base gradient */
    background:
      conic-gradient(
        from var(--sb-angle, 0deg),
        hsl(var(--primary)),
        hsl(var(--secondary)),
        hsl(var(--accent)),
        hsl(var(--primary))
      ) border-box,
      radial-gradient(120% 70% at 50% 15%, rgba(255,255,255,0.35), rgba(255,255,255,0) 60%) padding-box,
      linear-gradient(180deg,
        hsl(var(--primary) / 0.95),
        hsl(var(--secondary) / 0.95)
      ) padding-box;
    background-origin: border-box, padding-box, padding-box;
    background-clip: border-box, padding-box, padding-box;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.45), 0 0 12px hsl(var(--primary) / 0.3);
    /* Spin the conic layer and flow the base gradient for motion */
    animation: sbAngleSpin 8s linear infinite, scrollbarThumbFlow 4s ease-in-out infinite;
  }
  *::-webkit-scrollbar-thumb:hover {
    animation-duration: 3s, 2.2s; /* faster spin and flow on hover */
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.55), 0 0 16px hsl(var(--primary) / 0.45), 0 0 24px hsl(var(--secondary) / 0.35);
  }
  *::-webkit-scrollbar-thumb:active {
    /* Stronger glow and denser gradient while dragging */
    border-color: hsl(var(--background) / 0.45);
    animation-duration: 1.2s, 1.2s; /* quickest when active */
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.6), 0 0 20px hsl(var(--primary) / 0.55), 0 0 30px hsl(var(--secondary) / 0.4);
  }
  *::-webkit-scrollbar-corner { background: transparent; }

  /* Explicitly style the page scrollbar (helps on Edge/overlay scrollbars) */
  html::-webkit-scrollbar {
    width: 12px !important;
    height: 12px !important;
    background: transparent;
  }
  html::-webkit-scrollbar-track {
    border-radius: 9999px;
    background: hsl(var(--background) / 0.9);
    box-shadow: inset 0 0 0 1px hsl(var(--border) / 0.2);
  }
  html::-webkit-scrollbar-thumb {
    border-radius: 9999px;
    border: 2px solid hsl(var(--background) / 0.6);
    background:
      conic-gradient(
        from var(--sb-angle, 0deg),
        hsl(var(--primary)),
        hsl(var(--secondary)),
        hsl(var(--accent)),
        hsl(var(--primary))
      ) border-box,
      radial-gradient(120% 70% at 50% 15%, rgba(255,255,255,0.35), rgba(255,255,255,0) 60%) padding-box,
      linear-gradient(180deg,
        hsl(var(--primary) / 0.95),
        hsl(var(--secondary) / 0.95)
      ) padding-box;
    background-origin: border-box, padding-box, padding-box;
    background-clip: border-box, padding-box, padding-box;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.45), 0 0 12px hsl(var(--primary) / 0.3);
    animation: sbAngleSpin 8s linear infinite, scrollbarThumbFlow 4s ease-in-out infinite;
  }
  html::-webkit-scrollbar-thumb:hover {
    animation-duration: 3s, 2.2s;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.55), 0 0 16px hsl(var(--primary) / 0.45), 0 0 24px hsl(var(--secondary) / 0.35);
  }
  html::-webkit-scrollbar-thumb:active {
    border-color: hsl(var(--background) / 0.45);
    animation-duration: 1.2s, 1.2s;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.6), 0 0 20px hsl(var(--primary) / 0.55), 0 0 30px hsl(var(--secondary) / 0.4);
  }

  /* Body as root scroller (common on some setups) */
  body::-webkit-scrollbar { width: 12px !important; height: 12px !important; background: transparent; }
  body::-webkit-scrollbar-track {
    border-radius: 9999px;
    background: hsl(var(--background) / 0.9);
    box-shadow: inset 0 0 0 1px hsl(var(--border) / 0.2);
  }
  body::-webkit-scrollbar-thumb {
    border-radius: 9999px;
    border: 2px solid hsl(var(--background) / 0.6);
    background:
      conic-gradient(
        from var(--sb-angle, 0deg),
        hsl(var(--primary)),
        hsl(var(--secondary)),
        hsl(var(--accent)),
        hsl(var(--primary))
      ) border-box,
      radial-gradient(120% 70% at 50% 15%, rgba(255,255,255,0.35), rgba(255,255,255,0) 60%) padding-box,
      linear-gradient(180deg,
        hsl(var(--primary) / 0.95),
        hsl(var(--secondary) / 0.95)
      ) padding-box;
    background-origin: border-box, padding-box, padding-box;
    background-clip: border-box, padding-box, padding-box;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.45), 0 0 12px hsl(var(--primary) / 0.3);
    animation: sbAngleSpin 8s linear infinite, scrollbarThumbFlow 4s ease-in-out infinite;
  }
  body::-webkit-scrollbar-thumb:hover {
    animation-duration: 3s, 2.2s;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.55), 0 0 16px hsl(var(--primary) / 0.45), 0 0 24px hsl(var(--secondary) / 0.35);
  }
  body::-webkit-scrollbar-thumb:active {
    border-color: hsl(var(--background) / 0.45);
    animation-duration: 1.2s, 1.2s;
    box-shadow: 0 0 0 1px hsl(var(--border) / 0.6), 0 0 20px hsl(var(--primary) / 0.55), 0 0 30px hsl(var(--secondary) / 0.4);
  }

  /* High-contrast/forced-colors mode on Windows can override scrollbar colors; opt out to keep custom styling */
  @media (forced-colors: active) {
    *::-webkit-scrollbar,
    *::-webkit-scrollbar-track,
    *::-webkit-scrollbar-thumb { forced-color-adjust: none; }
  }

  @keyframes scrollbarThumbFlow {
    0% { background-position: 0% 0%; }
    50% { background-position: 0% 100%; }
    100% { background-position: 0% 0%; }
  }

  /* Respect reduced motion preferences */
  @media (prefers-reduced-motion: reduce) {
    *::-webkit-scrollbar-thumb { animation: none; }
  }
}